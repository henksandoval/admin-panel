@use 'sass:map';
@use './brand-palette' as brand;
@use '@angular/material' as mat;

$base-typography: (
  brand-family: 'Poppins, Inter, sans-serif',
  plain-family: 'Plus Jakarta Sans, Inter, sans-serif',
);

$theme-config: (
  'default': (primary: brand.$primary-palette, tertiary: brand.$tertiary-palette),
  'brand': (primary: brand.$primary-palette, tertiary: brand.$tertiary-palette),
  'azure': (primary: mat.$azure-palette, tertiary: mat.$cyan-palette),
  'teal': (primary: mat.$cyan-palette, tertiary: mat.$blue-palette),
  'rose': (primary: mat.$magenta-palette, tertiary: mat.$cyan-palette),
  'purple': (primary: mat.$violet-palette, tertiary: mat.$cyan-palette),
  'amber': (primary: mat.$orange-palette, tertiary: mat.$yellow-palette),
);

@mixin apply-theme($primary, $tertiary, $type: light) {
  $config: (
    color: (
      theme-type: $type,
      primary: $primary,
      tertiary: $tertiary,
    ),
    typography: $base-typography,
  );

  @include mat.theme($config);

  @include mat.toolbar-overrides((
    container-background-color: var(--mat-sys-primary),
    container-text-color: var(--mat-sys-on-primary)
  ));

  @include mat.sidenav-overrides((
    container-background-color: var(--mat-sys-primary),
    container-text-color: var(--mat-sys-on-primary)
  ));
}

@mixin apply-all-themes() {
  @each $color-name, $config in $theme-config {
    $primary: map.get($config, primary);
    $tertiary: map.get($config, tertiary);

    body.theme-#{$color-name}.light-theme {
      color-scheme: light;
      @include apply-theme($primary, $tertiary, light);
    }

    body.theme-#{$color-name}.dark-theme {
      color-scheme: dark;
      @include apply-theme($primary, $tertiary, dark);
    }
  }
}

@mixin define-overlay-tokens() {
  --overlay-on-primary-00: transparent;

  // ==========================================================================
  // OVERLAYS PARA SUPERFICIES PRIMARIAS (Sidebar header, elementos con fondo primario)
  // Usan --mat-sys-on-primary como base para garantizar contraste
  // ==========================================================================

  --overlay-on-primary-05: color-mix(in srgb, var(--mat-sys-on-primary) 5%, transparent);
  --overlay-on-primary-08: color-mix(in srgb, var(--mat-sys-on-primary) 8%, transparent);
  --overlay-on-primary-10: color-mix(in srgb, var(--mat-sys-on-primary) 10%, transparent);
  --overlay-on-primary-12: color-mix(in srgb, var(--mat-sys-on-primary) 12%, transparent);
  --overlay-on-primary-15: color-mix(in srgb, var(--mat-sys-on-primary) 15%, transparent);
  --overlay-on-primary-20: color-mix(in srgb, var(--mat-sys-on-primary) 20%, transparent);
  --overlay-on-primary-25: color-mix(in srgb, var(--mat-sys-on-primary) 25%, transparent);
  --overlay-on-primary-30: color-mix(in srgb, var(--mat-sys-on-primary) 30%, transparent);
  --overlay-on-primary-40: color-mix(in srgb, var(--mat-sys-on-primary) 40%, transparent);
  --overlay-on-primary-50: color-mix(in srgb, var(--mat-sys-on-primary) 50%, transparent);
  --overlay-on-primary-60: color-mix(in srgb, var(--mat-sys-on-primary) 60%, transparent);
  --overlay-on-primary-80: color-mix(in srgb, var(--mat-sys-on-primary) 80%, transparent);

  // ==========================================================================
  // OVERLAYS PARA SUPERFICIES (Cards, contenido, áreas con fondo surface)
  // Usan --mat-sys-on-surface como base
  // ==========================================================================

  --overlay-on-surface-05: color-mix(in srgb, var(--mat-sys-on-surface) 5%, transparent);
  --overlay-on-surface-08: color-mix(in srgb, var(--mat-sys-on-surface) 8%, transparent);
  --overlay-on-surface-10: color-mix(in srgb, var(--mat-sys-on-surface) 10%, transparent);
  --overlay-on-surface-12: color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent);
  --overlay-on-surface-15: color-mix(in srgb, var(--mat-sys-on-surface) 15%, transparent);
  --overlay-on-surface-20: color-mix(in srgb, var(--mat-sys-on-surface) 20%, transparent);
  --overlay-on-surface-25: color-mix(in srgb, var(--mat-sys-on-surface) 25%, transparent);
  --overlay-on-surface-30: color-mix(in srgb, var(--mat-sys-on-surface) 30%, transparent);
  --overlay-on-surface-40: color-mix(in srgb, var(--mat-sys-on-surface) 40%, transparent);
  --overlay-on-surface-50: color-mix(in srgb, var(--mat-sys-on-surface) 50%, transparent);

  // ==========================================================================
  // OVERLAYS INVERSOS (Para crear sombras o profundidad)
  // Usan --mat-sys-shadow o negro como base
  // ==========================================================================

  --overlay-shadow-05: color-mix(in srgb, var(--mat-sys-shadow, #000) 5%, transparent);
  --overlay-shadow-10: color-mix(in srgb, var(--mat-sys-shadow, #000) 10%, transparent);
  --overlay-shadow-15: color-mix(in srgb, var(--mat-sys-shadow, #000) 15%, transparent);
  --overlay-shadow-20: color-mix(in srgb, var(--mat-sys-shadow, #000) 20%, transparent);
  --overlay-shadow-25: color-mix(in srgb, var(--mat-sys-shadow, #000) 25%, transparent);

  // ==========================================================================
  // TOKENS SEMÁNTICOS PARA NAVEGACIÓN (Sidebar)
  // Abstracciones de alto nivel para estados de navegación
  // ==========================================================================

  // Estado hover en navegación
  --nav-item-hover-bg: var(--overlay-on-primary-12);

  // Estado activo (item seleccionado actualmente)
  --nav-item-active-bg: var(--overlay-on-primary-25);
  --nav-item-active-border: var(--overlay-on-primary-60);
  --nav-item-active-shadow: var(--overlay-shadow-15);

  // Estado parent-active (ancestro del item activo)
  --nav-item-parent-bg-start: var(--overlay-on-primary-15);
  --nav-item-parent-bg-mid: var(--overlay-on-primary-10);
  --nav-item-parent-bg-end: var(--overlay-on-primary-05);
  --nav-item-parent-border: var(--overlay-on-primary-20);

  // ==========================================================================
  // TOKENS PARA ÁREA DE NAVEGACIÓN (Superficie del nav-tree)
  // Para la opción híbrida: header primario, navegación en surface-container
  // ==========================================================================

  --nav-area-bg: var(--mat-sys-surface-container-low);
  --nav-area-text: var(--mat-sys-on-surface);
  --nav-area-text-secondary: var(--mat-sys-on-surface-variant);

  // Estados para navegación en área surface (no primaria)
  --nav-surface-hover-bg: var(--overlay-on-surface-08);
  --nav-surface-active-bg: var(--mat-sys-primary-container);
  --nav-surface-active-text: var(--mat-sys-on-primary-container);
  --nav-surface-active-border: var(--mat-sys-primary);
  --nav-surface-parent-bg: var(--overlay-on-surface-05);
}
