@use 'sass:map';
@use './variables';
@use './semantic-colors';
@use './tokens';
@use './material-overrides' as overrides;
@use './badges' as badges;
@use 'colors/aurora-tech' as aurora-tech;
@use 'colors/deep-ocean' as deep-ocean;
@use 'colors/forest-growth' as forest-growth;
@use 'colors/slate-minimal' as slate-minimal;
@use 'colors/sunset_analytics' as sunset-analytics;
@use 'colors/royal-dashboard' as royal-dashboard;
@use '@angular/material' as mat;

$base-typography: (
  brand-family: 'Poppins, Inter, sans-serif',
  plain-family: 'Plus Jakarta Sans, Inter, sans-serif',
);

$theme-config: (
  'default': (primary: aurora-tech.$primary-palette, tertiary: aurora-tech.$tertiary-palette),
  'aurora-tech':   (primary: aurora-tech.$primary-palette, tertiary: aurora-tech.$tertiary-palette),
  'deep-ocean': (primary: deep-ocean.$primary-palette,    tertiary: deep-ocean.$tertiary-palette),
  'forest-growth': (primary: forest-growth.$primary-palette,    tertiary: forest-growth.$tertiary-palette),
  'slate-minimal': (primary: slate-minimal.$primary-palette,    tertiary: slate-minimal.$tertiary-palette),
  'sunset-analytics': (primary: sunset-analytics.$primary-palette,    tertiary: sunset-analytics.$tertiary-palette),
  'royal-dashboard': (primary: royal-dashboard.$primary-palette,    tertiary: royal-dashboard.$tertiary-palette)
);

@mixin build-themes() {
  @include _apply-all-themes();
  @include overrides.apply-material-overrides();
  @include badges.badge-complete();

  body {
    @include tokens.define-overlay-tokens();
    @include tokens.define-badge-tokens();
  }

  .dark-theme {
    @include tokens.define-overlay-tokens-dark();
    @include tokens.define-badge-tokens-dark();
  }
}

@mixin _apply-all-themes() {
  @each $color-name, $config in $theme-config {
    $primary: map.get($config, primary);
    $tertiary: map.get($config, tertiary);

    body.theme-#{$color-name}.light-theme {
      color-scheme: light;
      @include tokens.define-chrome-tokens(light);
      @include _apply-theme($primary, $tertiary, light);
    }

    body.theme-#{$color-name}.dark-theme {
      color-scheme: dark;
      @include tokens.define-chrome-tokens(dark);
      @include _apply-theme($primary, $tertiary, dark);
    }
  }
}

@mixin _apply-theme($primary, $tertiary, $type: light) {
  $config: (
    color: (
      theme-type: $type,
      primary: $primary,
      tertiary: $tertiary,
    ),
    typography: $base-typography,
  );

  @include mat.theme($config);
  @include overrides.apply-component-overrides();
}
