<div
  class="floating-nav"
  [style.top.px]="topPosition()"
  (mouseleave)="onMouseLeave()">
  @for (item of items(); track item.id) {
    <div class="floating-nav-item">
      <button
        mat-button
        class="w-full justify-start gap-3 px-4"
        [class.active]="isActive(item.url)"
        (click)="handleItemClick(item)">

        <mat-icon [color]="item.badge ? 'primary' : undefined">
          {{ item.icon }}
        </mat-icon>

        <span class="flex-1 text-left truncate">{{ item.title }}</span>

        @if (item.badge) {
          <span class="badge" [class.badge-important]="item.badge.type === 'important'">
            {{ item.badge.title }}
          </span>
        }

        @if (hasChildren(item)) {
          <mat-icon class="expand-icon text-white/50">
            {{ isExpanded(item.id) ? 'expand_less' : 'expand_more' }}
          </mat-icon>
        }
      </button>

      @if (hasChildren(item) && isExpanded(item.id)) {
        <div class="floating-nav-children">
          @for (child of item.children; track child.id) {
            <div class="floating-nav-child-item">
              <button
                mat-button
                class="w-full justify-start gap-3 px-4 pl-12"
                [class.active]="isActive(child.url)"
                (click)="handleItemClick(child)">

                @if (child.icon) {
                  <mat-icon [color]="child.badge ? 'primary' : undefined">
                    {{ child.icon }}
                  </mat-icon>
                }

                <span class="flex-1 text-left truncate">{{ child.title }}</span>

                @if (child.badge) {
                  <span class="badge" [class.badge-important]="child.badge.type === 'important'">
                    {{ child.badge.title }}
                  </span>
                }

                @if (hasChildren(child)) {
                  <mat-icon class="expand-icon text-white/50">
                    {{ isExpanded(child.id) ? 'expand_less' : 'expand_more' }}
                  </mat-icon>
                }
              </button>

              @if (hasChildren(child) && isExpanded(child.id)) {
                <div class="floating-nav-nested">
                  @for (nested of child.children; track nested.id) {
                    <button
                      mat-button
                      class="w-full justify-start gap-3 px-4 pl-16"
                      [class.active]="isActive(nested.url)"
                      (click)="handleItemClick(nested)">

                      @if (nested.icon) {
                        <mat-icon>{{ nested.icon }}</mat-icon>
                      }

                      <span class="flex-1 text-left truncate">{{ nested.title }}</span>

                      @if (nested.badge) {
                        <span class="badge" [class.badge-important]="nested.badge.type === 'important'">
                          {{ nested.badge.title }}
                        </span>
                      }
                    </button>
                  }
                </div>
              }
            </div>
          }
        </div>
      }
    </div>
  }
</div>

